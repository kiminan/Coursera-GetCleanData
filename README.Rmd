---
title: "README - run_analysis.R"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### 'Getting and Cleaning Data' Course Project

This documents explains the steps in the script "run_analysis.R"

##### Fetch metadata
```{r eval=FALSE}
activity_labels <- 
    read.csv("data/assignment/activity_labels.txt", 
             header = FALSE, sep = "", col.names = c("activityid", "activity"))
features <- 
    read.csv("data/assignment/features.txt", 
             header = FALSE, sep = "")[2] ## Ignore first column
```

##### Fetch training data
```{r eval=FALSE}
subject_train <- read.csv("data/assignment/train/subject_train.txt", 
                          header = FALSE, col.names = "subjectid")

y_train <- read.csv("data/assignment/train/y_train.txt", 
                    header = FALSE, col.names = "activityid")

X_train <- read.csv("data/assignment/train/X_train.txt", 
                    header = FALSE, sep = "")
```
##### Fetch test data
```{r eval=FALSE}
subject_test <- read.csv("data/assignment/test/subject_test.txt", 
                         header = FALSE, col.names = "subjectid")

y_test <- read.csv("data/assignment/test/y_test.txt", 
                   header = FALSE, col.names = "activityid")

X_test <- read.csv("data/assignment/test/X_test.txt", 
                   header = FALSE, sep = "")
```
##### Merge the training and the test sets to create one data set
```{r eval=FALSE}
subjects <- rbind(subject_train, subject_test)
activities <- rbind(y_train, y_test)
dataset0 <- rbind(X_train, X_test)
```

##### Use descriptive column names
```{r eval=FALSE}
names(dataset0) <- features[,1]
```

##### Extract the measurements on the mean and standard deviation for each measurement
Find all columns with names that contain the strings "mean" or "std"
```{r eval=FALSE}
statsColumns <- grepl("mean|std", names(dataset0), ignore.case = TRUE)
dataset <- dataset0[statsColumns]
```

##### Attach subjects & activities to the dataset
```{r eval=FALSE}
dataset <- cbind(activities, subjects, dataset)
```

##### Use descriptive activity names to name the activities in the data set
Merge() will change the order of the data, therefore this step must be performed after activities have been merged with data.
```{r eval=FALSE}
dataset <- merge(dataset, activity_labels)
```
  
##### Remove column 'activityid', move column 'activity' to the front
```{r eval=FALSE}
dataset$activityid <- dataset$activity
dataset$activity <- NULL
names(dataset)[1] <- "activity"
```

##### Appropriately label the data set with descriptive variable names


##### Create a second, independent tidy data set with the average of each variable for each activity and each subject.
```{r eval=FALSE}
dataset2 <- dataset %>% 
  group_by(subjectid, activity) %>%
  summarise_all(funs(mean))

#Persist the new dataset
write.csv(dataset2,"data/assignment/dataset2.csv", row.names = FALSE )

```
